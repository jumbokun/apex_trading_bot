# 自动化交易系统功能特性

## 核心功能

### 1️⃣ 智能市场扫描

**实时监控市场动态**
- ✅ 多交易对并行扫描
- ✅ 可配置扫描间隔（建议60-300秒）
- ✅ K线数据分析（支持1m到1d多种周期）
- ✅ 成交量和波动性监控

**技术指标分析**
- ✅ 双均线系统（SMA/EMA）
- ✅ RSI超买超卖识别
- ✅ 成交量激增检测
- ✅ 波动率（ATR）计算
- ✅ 多因子综合评分

**信号生成**
- ✅ 买入/卖出信号
- ✅ 信号强度评分（0-1）
- ✅ 信号原因详细说明
- ✅ 最小信号强度过滤

---

### 2️⃣ 自动仓位管理

**持仓同步**
- ✅ 启动时自动同步现有持仓
- ✅ 定期更新持仓状态
- ✅ 实时价格和盈亏计算
- ✅ 保证金率监控

**智能开仓**
- ✅ 基于信号强度计算仓位大小
- ✅ 遵守最大仓位限制
- ✅ 考虑账户余额
- ✅ 检查最小下单量要求

**动态加减仓**
- ✅ 盈利时小幅加仓
- ✅ 亏损时及时减仓
- ✅ 仓位占比控制
- ✅ 避免过度交易

---

### 3️⃣ 多层风险控制

**🛡️ 爆仓保护（核心安全机制）**
- ✅ 保证金率实时监控
- ✅ 低于20%紧急平仓
- ✅ 低于15%警告提示
- ✅ 远高于交易所爆仓线（通常5-10%）

**🎯 止损止盈系统**
- ✅ 固定止损（默认2%）
- ✅ 固定止盈（默认5%）
- ✅ 追踪止损（默认3%）
- ✅ 自动设置和更新
- ✅ 触发后立即执行

**📊 仓位风控**
- ✅ 单仓位最大占比限制
- ✅ 总仓位价值控制
- ✅ 最大杠杆限制
- ✅ 账户余额检查

**📅 每日风险限制**
- ✅ 每日最大亏损百分比
- ✅ 达到限制自动停止交易
- ✅ 每日最大交易次数
- ✅ 防止过度交易和追损

**🌪️ 市场环境过滤**
- ✅ 极端波动时不交易
- ✅ 成交量不足时不交易
- ✅ 资金费率过高时不交易
- ✅ 保护资金安全

---

### 4️⃣ 自动评价系统

**实时评估**
- ✅ 账户状态评价
- ✅ 仓位健康度分析
- ✅ 今日表现评分
- ✅ 交易频率评估

**风险报告**
- ✅ 账户余额和权益
- ✅ 持仓数量和价值
- ✅ 未实现盈亏统计
- ✅ 保证金率分析
- ✅ 今日交易统计

**智能建议**
- ✅ 仓位过大警告
- ✅ 保证金率低提示
- ✅ 亏损接近限制告警
- ✅ 盈利表现鼓励

---

### 5️⃣ 状态持久化

**自动保存**
- ✅ 定期保存交易状态
- ✅ 持仓信息持久化
- ✅ 每日统计数据保存
- ✅ JSON格式易读易修改

**崩溃恢复**
- ✅ 程序重启后自动恢复
- ✅ 持仓信息不丢失
- ✅ 每日统计延续
- ✅ 优雅的错误处理

---

### 6️⃣ 日志和监控

**多级日志**
- ✅ 控制台彩色输出
- ✅ 文件详细日志
- ✅ 按日期自动轮换
- ✅ 自动压缩旧日志（保留30天）

**实时监控信息**
- ✅ 市场扫描进度
- ✅ 信号生成通知
- ✅ 订单执行状态
- ✅ 风险控制操作
- ✅ 错误和警告提示

---

## 安全特性

### 为什么可以放心2-3天？

#### ✅ 自动止损保护
```
每个持仓都有：
1. 固定止损价格（开仓时自动设置）
2. 追踪止损价格（盈利时自动更新）
3. 止盈价格（锁定利润）

示例：
开仓价：100,000 USDC
止损价：98,000 USDC（-2%）
止盈价：105,000 USDC（+5%）
追踪止损：102,000 USDC（从最高价103,000回调3%）
```

#### ✅ 爆仓保护机制
```
多层保护：
1. 保证金率 < 20%：紧急平仓
2. 保证金率 < 15%：发出警告
3. 交易所爆仓线：通常5-10%

安全边际：10-15%
```

#### ✅ 每日亏损熔断
```
如果今日亏损达到5%（可配置）：
1. 立即停止新交易
2. 保持现有止损止盈有效
3. 继续监控持仓风险
4. 第二天自动重置
```

#### ✅ 状态持久化
```
程序意外退出后：
1. 自动保存最新状态
2. 重启后恢复所有数据
3. 继续执行风险控制
4. 持仓不受影响
```

---

## 交易策略

### 信号生成逻辑

#### 买入信号（多因子评分）
1. **趋势确认**（30%权重）
   - 短期均线 > 长期均线

2. **价格位置**（10%权重）
   - 当前价格 > 短期均线

3. **RSI超卖**（30%权重）
   - RSI < 30（超卖区域）

4. **成交量确认**（20%权重）
   - 成交量 > 平均成交量 × 1.5倍

5. **温和信号**（10%权重）
   - RSI在40-60中性区域，但趋势向上

**总评分 >= 0.6 才生成信号**

#### 卖出信号（对称逻辑）
- 短期均线 < 长期均线
- 当前价格 < 短期均线
- RSI > 70（超买）
- 成交量激增确认
- 趋势向下

---

## 配置灵活性

### 三种预设配置

#### 🟢 安全保守（推荐新手）
```python
最大杠杆: 2倍
最大仓位: 5%
止损: 1.5%
止盈: 4%
时间框架: 1小时
每日最大亏损: 3%
每日最大交易: 10次
```

#### 🟡 平衡（默认）
```python
最大杠杆: 3倍
最大仓位: 10%
止损: 2%
止盈: 5%
时间框架: 15分钟
每日最大亏损: 5%
每日最大交易: 20次
```

#### 🔴 激进（高风险）
```python
最大杠杆: 5倍
最大仓位: 15%
止损: 3%
止盈: 8%
时间框架: 5分钟
每日最大亏损: 8%
每日最大交易: 30次
```

### 完全自定义
```python
# 所有参数都可以自由调整
config.risk.max_position_size = 0.08
config.risk.stop_loss_pct = 0.025
config.strategy.timeframe = "30m"
config.strategy.min_signal_strength = 0.7
# ... 更多参数
```

---

## 使用场景

### 场景1: 日常自动交易 ⭐
```
模式：持续运行
扫描间隔：60秒
运行方式：后台进程/服务器
适合：全自动交易
```

### 场景2: 定时检查风险
```
模式：单次运行
功能：只检查持仓风险
运行方式：cron定时任务
适合：半自动交易（手动开仓，自动止损）
```

### 场景3: 睡前安全检查
```
模式：风险检查模式
功能：
- 同步持仓
- 设置止损止盈
- 检查保证金率
- 执行必要的平仓
运行方式：睡觉前手动运行一次
适合：确保睡眠时段安全
```

### 场景4: 回测和测试
```
模式：模拟模式
功能：不实际下单，只记录
运行方式：测试网 + dry_run
适合：策略验证
```

---

## 技术优势

### 高可靠性
- ✅ 异常处理完善
- ✅ 网络错误自动重试
- ✅ 状态持久化
- ✅ 优雅退出机制

### 高性能
- ✅ 异步API调用
- ✅ 批量数据处理
- ✅ 高效的技术指标计算
- ✅ 最小化API请求次数

### 可扩展性
- ✅ 模块化设计
- ✅ 易于添加新策略
- ✅ 可自定义技术指标
- ✅ 支持多交易对

### 易用性
- ✅ 一键启动脚本
- ✅ 交互式配置
- ✅ 详细的日志输出
- ✅ 完整的文档

---

## 系统要求

### 软件要求
- Python 3.8+
- numpy
- loguru
- httpx

### 硬件要求
- CPU: 1核心
- 内存: 512MB
- 磁盘: 100MB（主要用于日志）

### 网络要求
- 稳定的互联网连接
- 建议使用VPS（云服务器）
- 低延迟（< 200ms到Apex服务器）

---

## 总结

这是一个**生产级别**的自动化交易系统，具有：

✅ **完整的风险控制**（止损、止盈、爆仓保护、每日限制）
✅ **智能的交易策略**（量价分析、趋势跟踪、多因子评分）
✅ **自动化的操作**（扫描、开仓、平仓、评价）
✅ **可靠的安全保障**（可放心2-3天不监控）
✅ **灵活的配置**（三种预设+完全自定义）
✅ **友好的使用体验**（一键启动、详细日志、自动恢复）

适合各种使用场景，从新手到专业交易者都可以找到合适的配置。
